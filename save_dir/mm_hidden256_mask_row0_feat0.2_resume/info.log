2021-12-16 14:32:11,848 - train - INFO - MultiIndexModel2(
  (embedder): FixedEmbedder(
    (embeddings): ModuleList(
      (0): Embedding(49, 32)
      (1): Embedding(4, 32)
      (2): Embedding(7, 32)
      (3): Embedding(30, 32)
      (4): Embedding(3, 32)
      (5): Embedding(12, 32)
      (6): Embedding(35, 32)
      (7): Embedding(3, 32)
      (8): Embedding(10, 32)
      (9): Embedding(2, 32)
    )
    (nns): ModuleList(
      (0): Linear(in_features=1, out_features=32, bias=True)
      (1): Linear(in_features=1, out_features=32, bias=True)
      (2): Linear(in_features=1, out_features=32, bias=True)
      (3): Linear(in_features=1, out_features=32, bias=True)
      (4): Linear(in_features=1, out_features=32, bias=True)
      (5): Linear(in_features=1, out_features=32, bias=True)
      (6): Linear(in_features=1, out_features=32, bias=True)
      (7): Linear(in_features=1, out_features=32, bias=True)
      (8): Linear(in_features=1, out_features=32, bias=True)
      (9): Linear(in_features=1, out_features=32, bias=True)
      (10): Linear(in_features=1, out_features=32, bias=True)
      (11): Linear(in_features=1, out_features=32, bias=True)
      (12): Linear(in_features=1, out_features=32, bias=True)
      (13): Linear(in_features=1, out_features=32, bias=True)
      (14): Linear(in_features=1, out_features=32, bias=True)
      (15): Linear(in_features=1, out_features=32, bias=True)
      (16): Linear(in_features=1, out_features=32, bias=True)
      (17): Linear(in_features=1, out_features=32, bias=True)
      (18): Linear(in_features=1, out_features=32, bias=True)
      (19): Linear(in_features=1, out_features=32, bias=True)
      (20): Linear(in_features=1, out_features=32, bias=True)
      (21): Linear(in_features=1, out_features=32, bias=True)
      (22): Linear(in_features=1, out_features=32, bias=True)
      (23): Linear(in_features=1, out_features=32, bias=True)
      (24): Linear(in_features=1, out_features=32, bias=True)
      (25): Linear(in_features=1, out_features=32, bias=True)
      (26): Linear(in_features=1, out_features=32, bias=True)
      (27): Linear(in_features=1, out_features=32, bias=True)
      (28): Linear(in_features=1, out_features=32, bias=True)
      (29): Linear(in_features=1, out_features=32, bias=True)
      (30): Linear(in_features=1, out_features=32, bias=True)
      (31): Linear(in_features=1, out_features=32, bias=True)
      (32): Linear(in_features=1, out_features=32, bias=True)
      (33): Linear(in_features=1, out_features=32, bias=True)
      (34): Linear(in_features=1, out_features=32, bias=True)
      (35): Linear(in_features=1, out_features=32, bias=True)
      (36): Linear(in_features=1, out_features=32, bias=True)
      (37): Linear(in_features=1, out_features=32, bias=True)
      (38): Linear(in_features=1, out_features=32, bias=True)
      (39): Linear(in_features=1, out_features=32, bias=True)
      (40): Linear(in_features=1, out_features=32, bias=True)
      (41): Linear(in_features=1, out_features=32, bias=True)
    )
  )
  (row_encoder): Sequential(
    (0): Linear(in_features=1664, out_features=1536, bias=True)
    (1): LeakyReLU(negative_slope=0.01)
    (2): Dropout(p=0.6, inplace=False)
    (3): Linear(in_features=1536, out_features=1024, bias=True)
    (4): LeakyReLU(negative_slope=0.01)
    (5): Dropout(p=0.39999999999999997, inplace=False)
    (6): Linear(in_features=1024, out_features=512, bias=True)
    (7): LeakyReLU(negative_slope=0.01)
    (8): Dropout(p=0.3, inplace=False)
    (9): Linear(in_features=512, out_features=256, bias=True)
    (10): LeakyReLU(negative_slope=0.01)
  )
  (rows_aggregator): Sequential(
    (0): Linear(in_features=12544, out_features=1536, bias=True)
    (1): LeakyReLU(negative_slope=0.01)
    (2): Dropout(p=0.6, inplace=False)
    (3): Linear(in_features=1536, out_features=1024, bias=True)
    (4): LeakyReLU(negative_slope=0.01)
    (5): Dropout(p=0.39999999999999997, inplace=False)
    (6): Linear(in_features=1024, out_features=512, bias=True)
    (7): LeakyReLU(negative_slope=0.01)
    (8): Dropout(p=0.3, inplace=False)
    (9): Linear(in_features=512, out_features=256, bias=True)
    (10): LeakyReLU(negative_slope=0.01)
  )
  (temporal_aggregator): Seq2SeqGruAggregator(
    (gru): GRU(256, 512, num_layers=3, batch_first=True, dropout=0.4)
  )
  (classifier): Sequential(
    (0): Linear(in_features=512, out_features=49, bias=True)
  )
)
Trainable parameters: 30653969
2021-12-16 14:33:19,516 - trainer - INFO - Loading checkpoint: ../save_dir/mm_hidden256_mask_row0.1_feat0.2/model_best.pth ...
2021-12-16 14:33:28,405 - trainer - WARNING - Warning: Architecture configuration given in config file is different from that of checkpoint. This may yield an exception while state_dict is being loaded.
2021-12-16 14:33:28,641 - trainer - INFO - Checkpoint loaded. Resume training from epoch 43
2021-12-16 14:45:44,414 - trainer - INFO -     epoch          : 43
2021-12-16 14:45:44,447 - trainer - INFO -     loss           : 2.2053838714299414
2021-12-16 14:45:44,447 - trainer - INFO -     seq2seq_NDCG   : 0.6708124279975891
2021-12-16 14:45:44,447 - trainer - INFO -     seq2seq_NDCG16 : 0.7230780124664307
2021-12-16 14:45:44,447 - trainer - INFO -     val_loss       : 2.203478070511215
2021-12-16 14:45:44,448 - trainer - INFO -     val_seq2seq_NDCG: 0.6724563837051392
2021-12-16 14:45:44,448 - trainer - INFO -     val_seq2seq_NDCG16: 0.7252511978149414
2021-12-16 14:45:45,399 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-16 14:57:47,179 - trainer - INFO -     epoch          : 44
2021-12-16 14:57:47,231 - trainer - INFO -     loss           : 2.2044452431105834
2021-12-16 14:57:47,231 - trainer - INFO -     seq2seq_NDCG   : 0.671054482460022
2021-12-16 14:57:47,231 - trainer - INFO -     seq2seq_NDCG16 : 0.7232535481452942
2021-12-16 14:57:47,232 - trainer - INFO -     val_loss       : 2.201837798188016
2021-12-16 14:57:47,232 - trainer - INFO -     val_seq2seq_NDCG: 0.6728991866111755
2021-12-16 14:57:47,232 - trainer - INFO -     val_seq2seq_NDCG16: 0.7257168292999268
2021-12-16 14:57:57,165 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-16 15:10:28,562 - trainer - INFO -     epoch          : 45
2021-12-16 15:10:28,618 - trainer - INFO -     loss           : 2.2030749799193896
2021-12-16 15:10:28,618 - trainer - INFO -     seq2seq_NDCG   : 0.6714319586753845
2021-12-16 15:10:28,618 - trainer - INFO -     seq2seq_NDCG16 : 0.7234964370727539
2021-12-16 15:10:28,618 - trainer - INFO -     val_loss       : 2.2009586347017254
2021-12-16 15:10:28,618 - trainer - INFO -     val_seq2seq_NDCG: 0.6734477281570435
2021-12-16 15:10:28,618 - trainer - INFO -     val_seq2seq_NDCG16: 0.7258360385894775
2021-12-16 15:10:40,344 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-16 15:23:19,739 - trainer - INFO -     epoch          : 46
2021-12-16 15:23:19,791 - trainer - INFO -     loss           : 2.202614752893942
2021-12-16 15:23:19,792 - trainer - INFO -     seq2seq_NDCG   : 0.6715404391288757
2021-12-16 15:23:19,792 - trainer - INFO -     seq2seq_NDCG16 : 0.7235399484634399
2021-12-16 15:23:19,793 - trainer - INFO -     val_loss       : 2.2023013962639704
2021-12-16 15:23:19,793 - trainer - INFO -     val_seq2seq_NDCG: 0.6729817986488342
2021-12-16 15:23:19,793 - trainer - INFO -     val_seq2seq_NDCG16: 0.7254655957221985
2021-12-16 15:23:19,794 - trainer - INFO - Performance is lower than epoch: 45
2021-12-16 15:35:29,082 - trainer - INFO -     epoch          : 47
2021-12-16 15:35:29,109 - trainer - INFO -     loss           : 2.201652581083111
2021-12-16 15:35:29,110 - trainer - INFO -     seq2seq_NDCG   : 0.6718547940254211
2021-12-16 15:35:29,111 - trainer - INFO -     seq2seq_NDCG16 : 0.7237525582313538
2021-12-16 15:35:29,111 - trainer - INFO -     val_loss       : 2.201267996967067
2021-12-16 15:35:29,111 - trainer - INFO -     val_seq2seq_NDCG: 0.6733284592628479
2021-12-16 15:35:29,112 - trainer - INFO -     val_seq2seq_NDCG16: 0.7256483435630798
2021-12-16 15:35:29,114 - trainer - INFO - Performance is lower than epoch: 45
2021-12-16 15:47:58,980 - trainer - INFO -     epoch          : 48
2021-12-16 15:47:59,021 - trainer - INFO -     loss           : 2.2011593793037987
2021-12-16 15:47:59,021 - trainer - INFO -     seq2seq_NDCG   : 0.6719123721122742
2021-12-16 15:47:59,021 - trainer - INFO -     seq2seq_NDCG16 : 0.7237548232078552
2021-12-16 15:47:59,022 - trainer - INFO -     val_loss       : 2.200812153432561
2021-12-16 15:47:59,022 - trainer - INFO -     val_seq2seq_NDCG: 0.6734477281570435
2021-12-16 15:47:59,022 - trainer - INFO -     val_seq2seq_NDCG16: 0.7256584167480469
2021-12-16 15:48:10,795 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-16 16:00:26,709 - trainer - INFO -     epoch          : 49
2021-12-16 16:00:26,738 - trainer - INFO -     loss           : 2.2003360689258393
2021-12-16 16:00:26,739 - trainer - INFO -     seq2seq_NDCG   : 0.6721032857894897
2021-12-16 16:00:26,739 - trainer - INFO -     seq2seq_NDCG16 : 0.7239519953727722
2021-12-16 16:00:26,740 - trainer - INFO -     val_loss       : 2.2021522394085298
2021-12-16 16:00:26,740 - trainer - INFO -     val_seq2seq_NDCG: 0.6729026436805725
2021-12-16 16:00:26,741 - trainer - INFO -     val_seq2seq_NDCG16: 0.7254496216773987
2021-12-16 16:00:26,742 - trainer - INFO - Performance is lower than epoch: 48
2021-12-16 16:12:26,573 - trainer - INFO -     epoch          : 50
2021-12-16 16:12:26,625 - trainer - INFO -     loss           : 2.199726118464845
2021-12-16 16:12:26,625 - trainer - INFO -     seq2seq_NDCG   : 0.6722972393035889
2021-12-16 16:12:26,625 - trainer - INFO -     seq2seq_NDCG16 : 0.7240607738494873
2021-12-16 16:12:26,626 - trainer - INFO -     val_loss       : 2.202199829035792
2021-12-16 16:12:26,626 - trainer - INFO -     val_seq2seq_NDCG: 0.6725155711174011
2021-12-16 16:12:26,626 - trainer - INFO -     val_seq2seq_NDCG16: 0.7245593070983887
2021-12-16 16:12:26,627 - trainer - INFO - Performance is lower than epoch: 48
2021-12-16 16:24:13,423 - trainer - INFO -     epoch          : 51
2021-12-16 16:24:13,464 - trainer - INFO -     loss           : 2.1991150745274695
2021-12-16 16:24:13,465 - trainer - INFO -     seq2seq_NDCG   : 0.6724327802658081
2021-12-16 16:24:13,465 - trainer - INFO -     seq2seq_NDCG16 : 0.7241325974464417
2021-12-16 16:24:13,465 - trainer - INFO -     val_loss       : 2.2004615063868265
2021-12-16 16:24:13,465 - trainer - INFO -     val_seq2seq_NDCG: 0.6736456751823425
2021-12-16 16:24:13,465 - trainer - INFO -     val_seq2seq_NDCG16: 0.7258262634277344
2021-12-16 16:24:18,321 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-16 16:36:33,541 - trainer - INFO -     epoch          : 52
2021-12-16 16:36:33,597 - trainer - INFO -     loss           : 2.1991816969613427
2021-12-16 16:36:33,598 - trainer - INFO -     seq2seq_NDCG   : 0.6723267436027527
2021-12-16 16:36:33,598 - trainer - INFO -     seq2seq_NDCG16 : 0.7241177558898926
2021-12-16 16:36:33,599 - trainer - INFO -     val_loss       : 2.201359990912836
2021-12-16 16:36:33,599 - trainer - INFO -     val_seq2seq_NDCG: 0.6730377674102783
2021-12-16 16:36:33,600 - trainer - INFO -     val_seq2seq_NDCG16: 0.7254268527030945
2021-12-16 16:36:33,602 - trainer - INFO - Performance is lower than epoch: 51
2021-12-16 16:48:49,773 - trainer - INFO -     epoch          : 53
2021-12-16 16:48:49,800 - trainer - INFO -     loss           : 2.198251416495574
2021-12-16 16:48:49,800 - trainer - INFO -     seq2seq_NDCG   : 0.6726096868515015
2021-12-16 16:48:49,800 - trainer - INFO -     seq2seq_NDCG16 : 0.7242214679718018
2021-12-16 16:48:49,801 - trainer - INFO -     val_loss       : 2.2008402475452056
2021-12-16 16:48:49,801 - trainer - INFO -     val_seq2seq_NDCG: 0.6733632683753967
2021-12-16 16:48:49,801 - trainer - INFO -     val_seq2seq_NDCG16: 0.7257305383682251
2021-12-16 16:48:49,802 - trainer - INFO - Performance is lower than epoch: 51
2021-12-16 17:00:49,993 - trainer - INFO -     epoch          : 54
2021-12-16 17:00:50,024 - trainer - INFO -     loss           : 2.1987388653398248
2021-12-16 17:00:50,024 - trainer - INFO -     seq2seq_NDCG   : 0.6725285649299622
2021-12-16 17:00:50,025 - trainer - INFO -     seq2seq_NDCG16 : 0.7241359949111938
2021-12-16 17:00:50,025 - trainer - INFO -     val_loss       : 2.2011892347956983
2021-12-16 17:00:50,026 - trainer - INFO -     val_seq2seq_NDCG: 0.6736088991165161
2021-12-16 17:00:50,026 - trainer - INFO -     val_seq2seq_NDCG16: 0.7256019115447998
2021-12-16 17:00:50,028 - trainer - INFO - Performance is lower than epoch: 51
2021-12-16 17:12:40,177 - trainer - INFO -     epoch          : 55
2021-12-16 17:12:40,225 - trainer - INFO -     loss           : 2.197401540750734
2021-12-16 17:12:40,225 - trainer - INFO -     seq2seq_NDCG   : 0.672851026058197
2021-12-16 17:12:40,226 - trainer - INFO -     seq2seq_NDCG16 : 0.7243678569793701
2021-12-16 17:12:40,226 - trainer - INFO -     val_loss       : 2.2014839420830152
2021-12-16 17:12:40,226 - trainer - INFO -     val_seq2seq_NDCG: 0.673360288143158
2021-12-16 17:12:40,226 - trainer - INFO -     val_seq2seq_NDCG16: 0.7254526019096375
2021-12-16 17:12:40,227 - trainer - INFO - Performance is lower than epoch: 51
2021-12-16 17:24:56,135 - trainer - INFO -     epoch          : 56
2021-12-16 17:24:56,172 - trainer - INFO -     loss           : 2.197091200301377
2021-12-16 17:24:56,172 - trainer - INFO -     seq2seq_NDCG   : 0.6728284358978271
2021-12-16 17:24:56,172 - trainer - INFO -     seq2seq_NDCG16 : 0.7243719696998596
2021-12-16 17:24:56,172 - trainer - INFO -     val_loss       : 2.2015043099721274
2021-12-16 17:24:56,172 - trainer - INFO -     val_seq2seq_NDCG: 0.6732276082038879
2021-12-16 17:24:56,172 - trainer - INFO -     val_seq2seq_NDCG16: 0.7257814407348633
2021-12-16 17:24:56,172 - trainer - INFO - Validation performance didn't improve for 4 epochs. Training stops.
