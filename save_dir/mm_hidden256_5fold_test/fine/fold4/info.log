2021-12-15 13:42:36,055 - train - INFO - MultiIndexModel2(
  (embedder): FixedEmbedder(
    (embeddings): ModuleList(
      (0): Embedding(49, 32)
      (1): Embedding(4, 32)
      (2): Embedding(7, 32)
      (3): Embedding(30, 32)
      (4): Embedding(3, 32)
      (5): Embedding(12, 32)
      (6): Embedding(35, 32)
      (7): Embedding(3, 32)
      (8): Embedding(10, 32)
      (9): Embedding(2, 32)
    )
    (nns): ModuleList(
      (0): Linear(in_features=1, out_features=32, bias=True)
      (1): Linear(in_features=1, out_features=32, bias=True)
      (2): Linear(in_features=1, out_features=32, bias=True)
      (3): Linear(in_features=1, out_features=32, bias=True)
      (4): Linear(in_features=1, out_features=32, bias=True)
      (5): Linear(in_features=1, out_features=32, bias=True)
      (6): Linear(in_features=1, out_features=32, bias=True)
      (7): Linear(in_features=1, out_features=32, bias=True)
      (8): Linear(in_features=1, out_features=32, bias=True)
      (9): Linear(in_features=1, out_features=32, bias=True)
      (10): Linear(in_features=1, out_features=32, bias=True)
      (11): Linear(in_features=1, out_features=32, bias=True)
      (12): Linear(in_features=1, out_features=32, bias=True)
      (13): Linear(in_features=1, out_features=32, bias=True)
      (14): Linear(in_features=1, out_features=32, bias=True)
      (15): Linear(in_features=1, out_features=32, bias=True)
      (16): Linear(in_features=1, out_features=32, bias=True)
      (17): Linear(in_features=1, out_features=32, bias=True)
      (18): Linear(in_features=1, out_features=32, bias=True)
      (19): Linear(in_features=1, out_features=32, bias=True)
      (20): Linear(in_features=1, out_features=32, bias=True)
      (21): Linear(in_features=1, out_features=32, bias=True)
      (22): Linear(in_features=1, out_features=32, bias=True)
      (23): Linear(in_features=1, out_features=32, bias=True)
      (24): Linear(in_features=1, out_features=32, bias=True)
      (25): Linear(in_features=1, out_features=32, bias=True)
      (26): Linear(in_features=1, out_features=32, bias=True)
      (27): Linear(in_features=1, out_features=32, bias=True)
      (28): Linear(in_features=1, out_features=32, bias=True)
      (29): Linear(in_features=1, out_features=32, bias=True)
      (30): Linear(in_features=1, out_features=32, bias=True)
      (31): Linear(in_features=1, out_features=32, bias=True)
      (32): Linear(in_features=1, out_features=32, bias=True)
      (33): Linear(in_features=1, out_features=32, bias=True)
      (34): Linear(in_features=1, out_features=32, bias=True)
      (35): Linear(in_features=1, out_features=32, bias=True)
      (36): Linear(in_features=1, out_features=32, bias=True)
      (37): Linear(in_features=1, out_features=32, bias=True)
      (38): Linear(in_features=1, out_features=32, bias=True)
      (39): Linear(in_features=1, out_features=32, bias=True)
      (40): Linear(in_features=1, out_features=32, bias=True)
      (41): Linear(in_features=1, out_features=32, bias=True)
    )
  )
  (row_encoder): Sequential(
    (0): Linear(in_features=1664, out_features=1536, bias=True)
    (1): LeakyReLU(negative_slope=0.01)
    (2): Dropout(p=0.6, inplace=False)
    (3): Linear(in_features=1536, out_features=1024, bias=True)
    (4): LeakyReLU(negative_slope=0.01)
    (5): Dropout(p=0.39999999999999997, inplace=False)
    (6): Linear(in_features=1024, out_features=512, bias=True)
    (7): LeakyReLU(negative_slope=0.01)
    (8): Dropout(p=0.3, inplace=False)
    (9): Linear(in_features=512, out_features=256, bias=True)
    (10): LeakyReLU(negative_slope=0.01)
  )
  (rows_aggregator): Sequential(
    (0): Linear(in_features=12544, out_features=1536, bias=True)
    (1): LeakyReLU(negative_slope=0.01)
    (2): Dropout(p=0.6, inplace=False)
    (3): Linear(in_features=1536, out_features=1024, bias=True)
    (4): LeakyReLU(negative_slope=0.01)
    (5): Dropout(p=0.39999999999999997, inplace=False)
    (6): Linear(in_features=1024, out_features=512, bias=True)
    (7): LeakyReLU(negative_slope=0.01)
    (8): Dropout(p=0.3, inplace=False)
    (9): Linear(in_features=512, out_features=256, bias=True)
    (10): LeakyReLU(negative_slope=0.01)
  )
  (temporal_aggregator): Seq2SeqGruAggregator(
    (gru): GRU(256, 512, num_layers=3, batch_first=True, dropout=0.4)
  )
  (classifier): Sequential(
    (0): Linear(in_features=512, out_features=49, bias=True)
  )
)
Trainable parameters: 30653969
2021-12-15 13:43:24,540 - trainer - INFO - Loading checkpoint: ../save_dir/mm_hidden256_5fold_test/base/fold4/model_best.pth ...
2021-12-15 13:43:41,276 - trainer - INFO - Checkpoint loaded. Resume training from epoch 42
2021-12-15 13:52:34,437 - trainer - INFO -     epoch          : 42
2021-12-15 13:52:34,514 - trainer - INFO -     loss           : 1.719056403339481
2021-12-15 13:52:34,515 - trainer - INFO -     seq2seq_NDCG   : 0.6676207780838013
2021-12-15 13:52:34,515 - trainer - INFO -     seq2seq_NDCG16 : 0.7259171009063721
2021-12-15 13:52:34,515 - trainer - INFO -     val_loss       : 1.7236784004983101
2021-12-15 13:52:34,515 - trainer - INFO -     val_seq2seq_NDCG: 0.6656293272972107
2021-12-15 13:52:34,515 - trainer - INFO -     val_seq2seq_NDCG16: 0.7249854803085327
2021-12-15 13:52:35,565 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-15 14:01:29,800 - trainer - INFO -     epoch          : 43
2021-12-15 14:01:29,877 - trainer - INFO -     loss           : 1.7175385990893315
2021-12-15 14:01:29,877 - trainer - INFO -     seq2seq_NDCG   : 0.6651600003242493
2021-12-15 14:01:29,878 - trainer - INFO -     seq2seq_NDCG16 : 0.726474404335022
2021-12-15 14:01:29,878 - trainer - INFO -     val_loss       : 1.724327400440478
2021-12-15 14:01:29,878 - trainer - INFO -     val_seq2seq_NDCG: 0.6624336242675781
2021-12-15 14:01:29,878 - trainer - INFO -     val_seq2seq_NDCG16: 0.7246484756469727
2021-12-15 14:01:29,880 - trainer - INFO - Performance is lower than epoch: 42
2021-12-15 14:10:23,442 - trainer - INFO -     epoch          : 44
2021-12-15 14:10:23,608 - trainer - INFO -     loss           : 1.7171487737296869
2021-12-15 14:10:23,608 - trainer - INFO -     seq2seq_NDCG   : 0.6618030071258545
2021-12-15 14:10:23,609 - trainer - INFO -     seq2seq_NDCG16 : 0.7266659736633301
2021-12-15 14:10:23,609 - trainer - INFO -     val_loss       : 1.724481338763055
2021-12-15 14:10:23,609 - trainer - INFO -     val_seq2seq_NDCG: 0.6616154313087463
2021-12-15 14:10:23,609 - trainer - INFO -     val_seq2seq_NDCG16: 0.7249001264572144
2021-12-15 14:10:23,612 - trainer - INFO - Performance is lower than epoch: 42
2021-12-15 14:19:16,402 - trainer - INFO -     epoch          : 45
2021-12-15 14:19:16,547 - trainer - INFO -     loss           : 1.7158158051990502
2021-12-15 14:19:16,547 - trainer - INFO -     seq2seq_NDCG   : 0.6613032221794128
2021-12-15 14:19:16,547 - trainer - INFO -     seq2seq_NDCG16 : 0.7270587682723999
2021-12-15 14:19:16,547 - trainer - INFO -     val_loss       : 1.7235823068909972
2021-12-15 14:19:16,548 - trainer - INFO -     val_seq2seq_NDCG: 0.6612653136253357
2021-12-15 14:19:16,548 - trainer - INFO -     val_seq2seq_NDCG16: 0.7252379059791565
2021-12-15 14:19:47,243 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-15 14:28:46,159 - trainer - INFO -     epoch          : 46
2021-12-15 14:28:46,217 - trainer - INFO -     loss           : 1.7147956837161717
2021-12-15 14:28:46,218 - trainer - INFO -     seq2seq_NDCG   : 0.6611965298652649
2021-12-15 14:28:46,218 - trainer - INFO -     seq2seq_NDCG16 : 0.7273464798927307
2021-12-15 14:28:46,218 - trainer - INFO -     val_loss       : 1.7233674981211888
2021-12-15 14:28:46,218 - trainer - INFO -     val_seq2seq_NDCG: 0.6616261005401611
2021-12-15 14:28:46,218 - trainer - INFO -     val_seq2seq_NDCG16: 0.7251651883125305
2021-12-15 14:29:10,330 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-15 14:38:10,825 - trainer - INFO -     epoch          : 47
2021-12-15 14:38:10,897 - trainer - INFO -     loss           : 1.7140321557672833
2021-12-15 14:38:10,898 - trainer - INFO -     seq2seq_NDCG   : 0.6607463955879211
2021-12-15 14:38:10,898 - trainer - INFO -     seq2seq_NDCG16 : 0.7275639772415161
2021-12-15 14:38:10,898 - trainer - INFO -     val_loss       : 1.72334070788085
2021-12-15 14:38:10,898 - trainer - INFO -     val_seq2seq_NDCG: 0.660167396068573
2021-12-15 14:38:10,898 - trainer - INFO -     val_seq2seq_NDCG16: 0.7252594828605652
2021-12-15 14:38:31,410 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-15 14:47:30,664 - trainer - INFO -     epoch          : 48
2021-12-15 14:47:30,710 - trainer - INFO -     loss           : 1.7132514253001296
2021-12-15 14:47:30,711 - trainer - INFO -     seq2seq_NDCG   : 0.65989750623703
2021-12-15 14:47:30,711 - trainer - INFO -     seq2seq_NDCG16 : 0.7277671098709106
2021-12-15 14:47:30,711 - trainer - INFO -     val_loss       : 1.7228668209250646
2021-12-15 14:47:30,711 - trainer - INFO -     val_seq2seq_NDCG: 0.659696638584137
2021-12-15 14:47:30,711 - trainer - INFO -     val_seq2seq_NDCG16: 0.7253539562225342
2021-12-15 14:47:56,959 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-15 14:57:01,446 - trainer - INFO -     epoch          : 49
2021-12-15 14:57:01,466 - trainer - INFO -     loss           : 1.7126848292671102
2021-12-15 14:57:01,468 - trainer - INFO -     seq2seq_NDCG   : 0.6595239639282227
2021-12-15 14:57:01,468 - trainer - INFO -     seq2seq_NDCG16 : 0.7279420495033264
2021-12-15 14:57:01,468 - trainer - INFO -     val_loss       : 1.722622541980889
2021-12-15 14:57:01,468 - trainer - INFO -     val_seq2seq_NDCG: 0.6592051386833191
2021-12-15 14:57:01,468 - trainer - INFO -     val_seq2seq_NDCG16: 0.7255405187606812
2021-12-15 14:57:21,128 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-15 15:06:22,852 - trainer - INFO -     epoch          : 50
2021-12-15 15:06:22,885 - trainer - INFO -     loss           : 1.7119640059297236
2021-12-15 15:06:22,885 - trainer - INFO -     seq2seq_NDCG   : 0.6588068604469299
2021-12-15 15:06:22,886 - trainer - INFO -     seq2seq_NDCG16 : 0.7281525135040283
2021-12-15 15:06:22,886 - trainer - INFO -     val_loss       : 1.7230465211941086
2021-12-15 15:06:22,886 - trainer - INFO -     val_seq2seq_NDCG: 0.6576653718948364
2021-12-15 15:06:22,886 - trainer - INFO -     val_seq2seq_NDCG16: 0.7253116965293884
2021-12-15 15:06:22,887 - trainer - INFO - Performance is lower than epoch: 49
2021-12-15 15:15:25,787 - trainer - INFO -     epoch          : 51
2021-12-15 15:15:25,950 - trainer - INFO -     loss           : 1.7112975143425295
2021-12-15 15:15:25,950 - trainer - INFO -     seq2seq_NDCG   : 0.6580885648727417
2021-12-15 15:15:25,950 - trainer - INFO -     seq2seq_NDCG16 : 0.7283451557159424
2021-12-15 15:15:25,950 - trainer - INFO -     val_loss       : 1.723612642470207
2021-12-15 15:15:25,951 - trainer - INFO -     val_seq2seq_NDCG: 0.6583669185638428
2021-12-15 15:15:25,951 - trainer - INFO -     val_seq2seq_NDCG16: 0.7251573204994202
2021-12-15 15:15:25,952 - trainer - INFO - Performance is lower than epoch: 49
2021-12-15 15:24:29,618 - trainer - INFO -     epoch          : 52
2021-12-15 15:24:29,683 - trainer - INFO -     loss           : 1.7106223879757403
2021-12-15 15:24:29,683 - trainer - INFO -     seq2seq_NDCG   : 0.6576650142669678
2021-12-15 15:24:29,683 - trainer - INFO -     seq2seq_NDCG16 : 0.7285739183425903
2021-12-15 15:24:29,683 - trainer - INFO -     val_loss       : 1.7228694963091202
2021-12-15 15:24:29,684 - trainer - INFO -     val_seq2seq_NDCG: 0.6577602028846741
2021-12-15 15:24:29,684 - trainer - INFO -     val_seq2seq_NDCG16: 0.7254590392112732
2021-12-15 15:24:29,685 - trainer - INFO - Performance is lower than epoch: 49
2021-12-15 15:33:29,951 - trainer - INFO -     epoch          : 53
2021-12-15 15:33:30,003 - trainer - INFO -     loss           : 1.7100422544808855
2021-12-15 15:33:30,003 - trainer - INFO -     seq2seq_NDCG   : 0.657442569732666
2021-12-15 15:33:30,003 - trainer - INFO -     seq2seq_NDCG16 : 0.7286504507064819
2021-12-15 15:33:30,003 - trainer - INFO -     val_loss       : 1.7257823197896245
2021-12-15 15:33:30,003 - trainer - INFO -     val_seq2seq_NDCG: 0.6549399495124817
2021-12-15 15:33:30,003 - trainer - INFO -     val_seq2seq_NDCG16: 0.7245263457298279
2021-12-15 15:33:30,004 - trainer - INFO - Performance is lower than epoch: 49
2021-12-15 15:42:31,590 - trainer - INFO -     epoch          : 54
2021-12-15 15:42:31,621 - trainer - INFO -     loss           : 1.7109998759747467
2021-12-15 15:42:31,622 - trainer - INFO -     seq2seq_NDCG   : 0.6546028852462769
2021-12-15 15:42:31,622 - trainer - INFO -     seq2seq_NDCG16 : 0.7284179329872131
2021-12-15 15:42:31,622 - trainer - INFO -     val_loss       : 1.7236861563820876
2021-12-15 15:42:31,622 - trainer - INFO -     val_seq2seq_NDCG: 0.6551925539970398
2021-12-15 15:42:31,622 - trainer - INFO -     val_seq2seq_NDCG16: 0.7251378297805786
2021-12-15 15:42:31,622 - trainer - INFO - Validation performance didn't improve for 4 epochs. Training stops.
