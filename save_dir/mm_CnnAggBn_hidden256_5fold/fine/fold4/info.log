2021-12-26 17:57:11,600 - train - INFO - MultiIndexModelCnnAggBn(
  (embedder): FixedEmbedder(
    (embeddings): ModuleList(
      (0): Embedding(49, 32)
      (1): Embedding(4, 32)
      (2): Embedding(7, 32)
      (3): Embedding(30, 32)
      (4): Embedding(3, 32)
      (5): Embedding(12, 32)
      (6): Embedding(35, 32)
      (7): Embedding(3, 32)
      (8): Embedding(10, 32)
      (9): Embedding(2, 32)
    )
    (nns): ModuleList(
      (0): Linear(in_features=1, out_features=32, bias=True)
      (1): Linear(in_features=1, out_features=32, bias=True)
      (2): Linear(in_features=1, out_features=32, bias=True)
      (3): Linear(in_features=1, out_features=32, bias=True)
      (4): Linear(in_features=1, out_features=32, bias=True)
      (5): Linear(in_features=1, out_features=32, bias=True)
      (6): Linear(in_features=1, out_features=32, bias=True)
      (7): Linear(in_features=1, out_features=32, bias=True)
      (8): Linear(in_features=1, out_features=32, bias=True)
      (9): Linear(in_features=1, out_features=32, bias=True)
      (10): Linear(in_features=1, out_features=32, bias=True)
      (11): Linear(in_features=1, out_features=32, bias=True)
      (12): Linear(in_features=1, out_features=32, bias=True)
      (13): Linear(in_features=1, out_features=32, bias=True)
      (14): Linear(in_features=1, out_features=32, bias=True)
      (15): Linear(in_features=1, out_features=32, bias=True)
      (16): Linear(in_features=1, out_features=32, bias=True)
      (17): Linear(in_features=1, out_features=32, bias=True)
      (18): Linear(in_features=1, out_features=32, bias=True)
      (19): Linear(in_features=1, out_features=32, bias=True)
      (20): Linear(in_features=1, out_features=32, bias=True)
      (21): Linear(in_features=1, out_features=32, bias=True)
      (22): Linear(in_features=1, out_features=32, bias=True)
      (23): Linear(in_features=1, out_features=32, bias=True)
      (24): Linear(in_features=1, out_features=32, bias=True)
      (25): Linear(in_features=1, out_features=32, bias=True)
      (26): Linear(in_features=1, out_features=32, bias=True)
      (27): Linear(in_features=1, out_features=32, bias=True)
      (28): Linear(in_features=1, out_features=32, bias=True)
      (29): Linear(in_features=1, out_features=32, bias=True)
      (30): Linear(in_features=1, out_features=32, bias=True)
      (31): Linear(in_features=1, out_features=32, bias=True)
      (32): Linear(in_features=1, out_features=32, bias=True)
      (33): Linear(in_features=1, out_features=32, bias=True)
      (34): Linear(in_features=1, out_features=32, bias=True)
      (35): Linear(in_features=1, out_features=32, bias=True)
      (36): Linear(in_features=1, out_features=32, bias=True)
      (37): Linear(in_features=1, out_features=32, bias=True)
      (38): Linear(in_features=1, out_features=32, bias=True)
      (39): Linear(in_features=1, out_features=32, bias=True)
      (40): Linear(in_features=1, out_features=32, bias=True)
      (41): Linear(in_features=1, out_features=32, bias=True)
    )
  )
  (row_encoder): CnnEncoder(
    (batch_norm1): BatchNorm1d(1664, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout1): Dropout(p=0.44999999999999996, inplace=False)
    (dense1): Linear(in_features=1664, out_features=1536, bias=True)
    (batch_norm_c1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout_c1): Dropout(p=0.40499999999999997, inplace=False)
    (conv1): Conv1d(64, 128, kernel_size=(5,), stride=(1,), padding=(2,), bias=False)
    (ave_po_c1): AdaptiveAvgPool1d(output_size=12)
    (batch_norm_c2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout_c2): Dropout(p=0.36, inplace=False)
    (conv2): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    (batch_norm_c2_1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout_c2_1): Dropout(p=0.26999999999999996, inplace=False)
    (conv2_1): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    (batch_norm_c2_2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout_c2_2): Dropout(p=0.22499999999999998, inplace=False)
    (conv2_2): Conv1d(128, 128, kernel_size=(5,), stride=(1,), padding=(2,))
    (max_po_c2): MaxPool1d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)
    (flt): Flatten(start_dim=1, end_dim=-1)
    (batch_norm3): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout3): Dropout(p=0.44999999999999996, inplace=False)
    (dense3): Linear(in_features=768, out_features=256, bias=True)
  )
  (rows_aggregator): Sequential(
    (0): Linear(in_features=12544, out_features=1536, bias=True)
    (1): LeakyReLU(negative_slope=0.01)
    (2): Dropout(p=0.6, inplace=False)
    (3): BatchNormLastDim(
      (bn): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (4): Linear(in_features=1536, out_features=1024, bias=True)
    (5): LeakyReLU(negative_slope=0.01)
    (6): Dropout(p=0.39999999999999997, inplace=False)
    (7): BatchNormLastDim(
      (bn): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (8): Linear(in_features=1024, out_features=512, bias=True)
    (9): LeakyReLU(negative_slope=0.01)
    (10): Dropout(p=0.3, inplace=False)
    (11): BatchNormLastDim(
      (bn): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (12): Linear(in_features=512, out_features=256, bias=True)
    (13): LeakyReLU(negative_slope=0.01)
  )
  (temporal_aggregator): Seq2SeqGruAggregator(
    (gru): GRU(256, 512, num_layers=3, batch_first=True, dropout=0.4)
  )
  (classifier): Sequential(
    (0): Linear(in_features=512, out_features=49, bias=True)
  )
)
Trainable parameters: 28859413.0
2021-12-26 17:57:56,180 - trainer - INFO - Loading checkpoint: ../save_dir/mm_CnnAggBn_hidden256_5fold/base/fold4/model_best.pth ...
2021-12-26 17:58:01,845 - trainer - INFO - Checkpoint loaded. Resume training from epoch 28
2021-12-26 18:13:01,684 - trainer - INFO -     epoch          : 28
2021-12-26 18:13:01,730 - trainer - INFO -     loss           : 1.7221899520405723
2021-12-26 18:13:01,730 - trainer - INFO -     seq2seq_NDCG   : 0.6592218279838562
2021-12-26 18:13:01,731 - trainer - INFO -     seq2seq_NDCG16 : 0.7249157428741455
2021-12-26 18:13:01,731 - trainer - INFO -     val_loss       : 1.724428549713018
2021-12-26 18:13:01,731 - trainer - INFO -     val_seq2seq_NDCG: 0.6570210456848145
2021-12-26 18:13:01,731 - trainer - INFO -     val_seq2seq_NDCG16: 0.7248281836509705
2021-12-26 18:13:02,625 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-26 18:28:06,497 - trainer - INFO -     epoch          : 29
2021-12-26 18:28:06,548 - trainer - INFO -     loss           : 1.7200441991581636
2021-12-26 18:28:06,548 - trainer - INFO -     seq2seq_NDCG   : 0.6547800898551941
2021-12-26 18:28:06,548 - trainer - INFO -     seq2seq_NDCG16 : 0.7257577776908875
2021-12-26 18:28:06,548 - trainer - INFO -     val_loss       : 1.7243027322146358
2021-12-26 18:28:06,548 - trainer - INFO -     val_seq2seq_NDCG: 0.6553218364715576
2021-12-26 18:28:06,548 - trainer - INFO -     val_seq2seq_NDCG16: 0.7249569892883301
2021-12-26 18:28:10,453 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-26 18:43:18,877 - trainer - INFO -     epoch          : 30
2021-12-26 18:43:18,928 - trainer - INFO -     loss           : 1.71864257520422
2021-12-26 18:43:18,929 - trainer - INFO -     seq2seq_NDCG   : 0.6536774039268494
2021-12-26 18:43:18,929 - trainer - INFO -     seq2seq_NDCG16 : 0.7261648774147034
2021-12-26 18:43:18,929 - trainer - INFO -     val_loss       : 1.723962600133857
2021-12-26 18:43:18,929 - trainer - INFO -     val_seq2seq_NDCG: 0.6527605652809143
2021-12-26 18:43:18,929 - trainer - INFO -     val_seq2seq_NDCG16: 0.7253138422966003
2021-12-26 18:43:31,499 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-26 18:58:35,019 - trainer - INFO -     epoch          : 31
2021-12-26 18:58:35,081 - trainer - INFO -     loss           : 1.717625692677315
2021-12-26 18:58:35,081 - trainer - INFO -     seq2seq_NDCG   : 0.6519967913627625
2021-12-26 18:58:35,081 - trainer - INFO -     seq2seq_NDCG16 : 0.7264721393585205
2021-12-26 18:58:35,081 - trainer - INFO -     val_loss       : 1.7242082320913976
2021-12-26 18:58:35,082 - trainer - INFO -     val_seq2seq_NDCG: 0.6521797180175781
2021-12-26 18:58:35,082 - trainer - INFO -     val_seq2seq_NDCG16: 0.724788248538971
2021-12-26 18:58:35,084 - trainer - INFO - Performance is lower than epoch: 30
2021-12-26 19:13:41,903 - trainer - INFO -     epoch          : 32
2021-12-26 19:13:41,966 - trainer - INFO -     loss           : 1.7167480057462707
2021-12-26 19:13:41,966 - trainer - INFO -     seq2seq_NDCG   : 0.6511805057525635
2021-12-26 19:13:41,966 - trainer - INFO -     seq2seq_NDCG16 : 0.7267068028450012
2021-12-26 19:13:41,967 - trainer - INFO -     val_loss       : 1.7242807441828203
2021-12-26 19:13:41,967 - trainer - INFO -     val_seq2seq_NDCG: 0.6519320011138916
2021-12-26 19:13:41,967 - trainer - INFO -     val_seq2seq_NDCG16: 0.725003182888031
2021-12-26 19:13:41,968 - trainer - INFO - Performance is lower than epoch: 30
2021-12-26 19:29:00,328 - trainer - INFO -     epoch          : 33
2021-12-26 19:29:00,368 - trainer - INFO -     loss           : 1.7159257227807398
2021-12-26 19:29:00,369 - trainer - INFO -     seq2seq_NDCG   : 0.6504809856414795
2021-12-26 19:29:00,369 - trainer - INFO -     seq2seq_NDCG16 : 0.7269560098648071
2021-12-26 19:29:00,369 - trainer - INFO -     val_loss       : 1.7231711617537908
2021-12-26 19:29:00,369 - trainer - INFO -     val_seq2seq_NDCG: 0.6514642238616943
2021-12-26 19:29:00,370 - trainer - INFO -     val_seq2seq_NDCG16: 0.7254043817520142
2021-12-26 19:29:16,271 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-26 19:44:27,917 - trainer - INFO -     epoch          : 34
2021-12-26 19:44:27,965 - trainer - INFO -     loss           : 1.71511937453009
2021-12-26 19:44:27,965 - trainer - INFO -     seq2seq_NDCG   : 0.6498580574989319
2021-12-26 19:44:27,965 - trainer - INFO -     seq2seq_NDCG16 : 0.7271986603736877
2021-12-26 19:44:27,965 - trainer - INFO -     val_loss       : 1.7238915666025512
2021-12-26 19:44:27,965 - trainer - INFO -     val_seq2seq_NDCG: 0.6503743529319763
2021-12-26 19:44:27,965 - trainer - INFO -     val_seq2seq_NDCG16: 0.7250335812568665
2021-12-26 19:44:27,967 - trainer - INFO - Performance is lower than epoch: 33
2021-12-26 19:59:36,729 - trainer - INFO -     epoch          : 35
2021-12-26 19:59:36,763 - trainer - INFO -     loss           : 1.7142889545396771
2021-12-26 19:59:36,764 - trainer - INFO -     seq2seq_NDCG   : 0.6494452357292175
2021-12-26 19:59:36,764 - trainer - INFO -     seq2seq_NDCG16 : 0.7274678945541382
2021-12-26 19:59:36,764 - trainer - INFO -     val_loss       : 1.7239222788080877
2021-12-26 19:59:36,764 - trainer - INFO -     val_seq2seq_NDCG: 0.6488548517227173
2021-12-26 19:59:36,764 - trainer - INFO -     val_seq2seq_NDCG16: 0.7252479195594788
2021-12-26 19:59:36,765 - trainer - INFO - Performance is lower than epoch: 33
2021-12-26 20:14:59,284 - trainer - INFO -     epoch          : 36
2021-12-26 20:14:59,339 - trainer - INFO -     loss           : 1.71366039688325
2021-12-26 20:14:59,340 - trainer - INFO -     seq2seq_NDCG   : 0.6486033797264099
2021-12-26 20:14:59,340 - trainer - INFO -     seq2seq_NDCG16 : 0.7275981903076172
2021-12-26 20:14:59,340 - trainer - INFO -     val_loss       : 1.7239940555728213
2021-12-26 20:14:59,340 - trainer - INFO -     val_seq2seq_NDCG: 0.6486244201660156
2021-12-26 20:14:59,340 - trainer - INFO -     val_seq2seq_NDCG16: 0.7252222299575806
2021-12-26 20:14:59,342 - trainer - INFO - Performance is lower than epoch: 33
2021-12-26 20:30:12,168 - trainer - INFO -     epoch          : 37
2021-12-26 20:30:12,203 - trainer - INFO -     loss           : 1.7128358510753992
2021-12-26 20:30:12,204 - trainer - INFO -     seq2seq_NDCG   : 0.6484186053276062
2021-12-26 20:30:12,204 - trainer - INFO -     seq2seq_NDCG16 : 0.7278517484664917
2021-12-26 20:30:12,204 - trainer - INFO -     val_loss       : 1.7244494672940702
2021-12-26 20:30:12,204 - trainer - INFO -     val_seq2seq_NDCG: 0.6488305330276489
2021-12-26 20:30:12,204 - trainer - INFO -     val_seq2seq_NDCG16: 0.7250714898109436
2021-12-26 20:30:12,206 - trainer - INFO - Performance is lower than epoch: 33
2021-12-26 20:45:22,386 - trainer - INFO -     epoch          : 38
2021-12-26 20:45:22,436 - trainer - INFO -     loss           : 1.7123325270460086
2021-12-26 20:45:22,436 - trainer - INFO -     seq2seq_NDCG   : 0.6480164527893066
2021-12-26 20:45:22,436 - trainer - INFO -     seq2seq_NDCG16 : 0.7279658317565918
2021-12-26 20:45:22,436 - trainer - INFO -     val_loss       : 1.7242370758737837
2021-12-26 20:45:22,437 - trainer - INFO -     val_seq2seq_NDCG: 0.6482324004173279
2021-12-26 20:45:22,437 - trainer - INFO -     val_seq2seq_NDCG16: 0.7252869606018066
2021-12-26 20:45:22,437 - trainer - INFO - Validation performance didn't improve for 4 epochs. Training stops.
