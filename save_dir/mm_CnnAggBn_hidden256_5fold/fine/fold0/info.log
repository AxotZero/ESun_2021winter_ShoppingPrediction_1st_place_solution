2021-12-24 17:24:44,782 - train - INFO - MultiIndexModelCnnAggBn(
  (embedder): FixedEmbedder(
    (embeddings): ModuleList(
      (0): Embedding(49, 32)
      (1): Embedding(4, 32)
      (2): Embedding(7, 32)
      (3): Embedding(30, 32)
      (4): Embedding(3, 32)
      (5): Embedding(12, 32)
      (6): Embedding(35, 32)
      (7): Embedding(3, 32)
      (8): Embedding(10, 32)
      (9): Embedding(2, 32)
    )
    (nns): ModuleList(
      (0): Linear(in_features=1, out_features=32, bias=True)
      (1): Linear(in_features=1, out_features=32, bias=True)
      (2): Linear(in_features=1, out_features=32, bias=True)
      (3): Linear(in_features=1, out_features=32, bias=True)
      (4): Linear(in_features=1, out_features=32, bias=True)
      (5): Linear(in_features=1, out_features=32, bias=True)
      (6): Linear(in_features=1, out_features=32, bias=True)
      (7): Linear(in_features=1, out_features=32, bias=True)
      (8): Linear(in_features=1, out_features=32, bias=True)
      (9): Linear(in_features=1, out_features=32, bias=True)
      (10): Linear(in_features=1, out_features=32, bias=True)
      (11): Linear(in_features=1, out_features=32, bias=True)
      (12): Linear(in_features=1, out_features=32, bias=True)
      (13): Linear(in_features=1, out_features=32, bias=True)
      (14): Linear(in_features=1, out_features=32, bias=True)
      (15): Linear(in_features=1, out_features=32, bias=True)
      (16): Linear(in_features=1, out_features=32, bias=True)
      (17): Linear(in_features=1, out_features=32, bias=True)
      (18): Linear(in_features=1, out_features=32, bias=True)
      (19): Linear(in_features=1, out_features=32, bias=True)
      (20): Linear(in_features=1, out_features=32, bias=True)
      (21): Linear(in_features=1, out_features=32, bias=True)
      (22): Linear(in_features=1, out_features=32, bias=True)
      (23): Linear(in_features=1, out_features=32, bias=True)
      (24): Linear(in_features=1, out_features=32, bias=True)
      (25): Linear(in_features=1, out_features=32, bias=True)
      (26): Linear(in_features=1, out_features=32, bias=True)
      (27): Linear(in_features=1, out_features=32, bias=True)
      (28): Linear(in_features=1, out_features=32, bias=True)
      (29): Linear(in_features=1, out_features=32, bias=True)
      (30): Linear(in_features=1, out_features=32, bias=True)
      (31): Linear(in_features=1, out_features=32, bias=True)
      (32): Linear(in_features=1, out_features=32, bias=True)
      (33): Linear(in_features=1, out_features=32, bias=True)
      (34): Linear(in_features=1, out_features=32, bias=True)
      (35): Linear(in_features=1, out_features=32, bias=True)
      (36): Linear(in_features=1, out_features=32, bias=True)
      (37): Linear(in_features=1, out_features=32, bias=True)
      (38): Linear(in_features=1, out_features=32, bias=True)
      (39): Linear(in_features=1, out_features=32, bias=True)
      (40): Linear(in_features=1, out_features=32, bias=True)
      (41): Linear(in_features=1, out_features=32, bias=True)
    )
  )
  (row_encoder): CnnEncoder(
    (batch_norm1): BatchNorm1d(1664, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout1): Dropout(p=0.44999999999999996, inplace=False)
    (dense1): Linear(in_features=1664, out_features=1536, bias=True)
    (batch_norm_c1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout_c1): Dropout(p=0.40499999999999997, inplace=False)
    (conv1): Conv1d(64, 128, kernel_size=(5,), stride=(1,), padding=(2,), bias=False)
    (ave_po_c1): AdaptiveAvgPool1d(output_size=12)
    (batch_norm_c2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout_c2): Dropout(p=0.36, inplace=False)
    (conv2): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    (batch_norm_c2_1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout_c2_1): Dropout(p=0.26999999999999996, inplace=False)
    (conv2_1): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    (batch_norm_c2_2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout_c2_2): Dropout(p=0.22499999999999998, inplace=False)
    (conv2_2): Conv1d(128, 128, kernel_size=(5,), stride=(1,), padding=(2,))
    (max_po_c2): MaxPool1d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)
    (flt): Flatten(start_dim=1, end_dim=-1)
    (batch_norm3): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout3): Dropout(p=0.44999999999999996, inplace=False)
    (dense3): Linear(in_features=768, out_features=256, bias=True)
  )
  (rows_aggregator): Sequential(
    (0): Linear(in_features=12544, out_features=1536, bias=True)
    (1): LeakyReLU(negative_slope=0.01)
    (2): Dropout(p=0.6, inplace=False)
    (3): BatchNormLastDim(
      (bn): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (4): Linear(in_features=1536, out_features=1024, bias=True)
    (5): LeakyReLU(negative_slope=0.01)
    (6): Dropout(p=0.39999999999999997, inplace=False)
    (7): BatchNormLastDim(
      (bn): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (8): Linear(in_features=1024, out_features=512, bias=True)
    (9): LeakyReLU(negative_slope=0.01)
    (10): Dropout(p=0.3, inplace=False)
    (11): BatchNormLastDim(
      (bn): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (12): Linear(in_features=512, out_features=256, bias=True)
    (13): LeakyReLU(negative_slope=0.01)
  )
  (temporal_aggregator): Seq2SeqGruAggregator(
    (gru): GRU(256, 512, num_layers=3, batch_first=True, dropout=0.4)
  )
  (classifier): Sequential(
    (0): Linear(in_features=512, out_features=49, bias=True)
  )
)
Trainable parameters: 28859413.0
2021-12-24 17:25:38,576 - trainer - INFO - Loading checkpoint: ../save_dir/mm_CnnAggBn_hidden256_5fold/base/fold0/model_best.pth ...
2021-12-24 17:27:40,069 - trainer - INFO - Checkpoint loaded. Resume training from epoch 29
2021-12-24 17:42:19,840 - trainer - INFO -     epoch          : 29
2021-12-24 17:42:19,970 - trainer - INFO -     loss           : 1.7228414771501974
2021-12-24 17:42:19,970 - trainer - INFO -     seq2seq_NDCG   : 0.6636686325073242
2021-12-24 17:42:19,970 - trainer - INFO -     seq2seq_NDCG16 : 0.7246139645576477
2021-12-24 17:42:19,970 - trainer - INFO -     val_loss       : 1.719822259581819
2021-12-24 17:42:19,970 - trainer - INFO -     val_seq2seq_NDCG: 0.6624061465263367
2021-12-24 17:42:19,970 - trainer - INFO -     val_seq2seq_NDCG16: 0.7265792489051819
2021-12-24 17:42:20,985 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-24 17:57:05,422 - trainer - INFO -     epoch          : 30
2021-12-24 17:57:05,730 - trainer - INFO -     loss           : 1.7210373256517493
2021-12-24 17:57:05,730 - trainer - INFO -     seq2seq_NDCG   : 0.6595436930656433
2021-12-24 17:57:05,730 - trainer - INFO -     seq2seq_NDCG16 : 0.7252518534660339
2021-12-24 17:57:05,731 - trainer - INFO -     val_loss       : 1.718615852448405
2021-12-24 17:57:05,731 - trainer - INFO -     val_seq2seq_NDCG: 0.6614682674407959
2021-12-24 17:57:05,731 - trainer - INFO -     val_seq2seq_NDCG16: 0.7268134951591492
2021-12-24 18:00:25,222 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-24 18:15:12,607 - trainer - INFO -     epoch          : 31
2021-12-24 18:15:12,753 - trainer - INFO -     loss           : 1.7196049464633092
2021-12-24 18:15:12,754 - trainer - INFO -     seq2seq_NDCG   : 0.6580590605735779
2021-12-24 18:15:12,754 - trainer - INFO -     seq2seq_NDCG16 : 0.7257266044616699
2021-12-24 18:15:12,754 - trainer - INFO -     val_loss       : 1.7189039861669346
2021-12-24 18:15:12,754 - trainer - INFO -     val_seq2seq_NDCG: 0.6598742008209229
2021-12-24 18:15:12,754 - trainer - INFO -     val_seq2seq_NDCG16: 0.7270535826683044
2021-12-24 18:15:12,755 - trainer - INFO - Performance is lower than epoch: 30
2021-12-24 18:29:57,419 - trainer - INFO -     epoch          : 32
2021-12-24 18:29:57,481 - trainer - INFO -     loss           : 1.7184649152524025
2021-12-24 18:29:57,481 - trainer - INFO -     seq2seq_NDCG   : 0.6566029191017151
2021-12-24 18:29:57,481 - trainer - INFO -     seq2seq_NDCG16 : 0.7261620163917542
2021-12-24 18:29:57,481 - trainer - INFO -     val_loss       : 1.7192637786573293
2021-12-24 18:29:57,481 - trainer - INFO -     val_seq2seq_NDCG: 0.6587717533111572
2021-12-24 18:29:57,482 - trainer - INFO -     val_seq2seq_NDCG16: 0.7268557548522949
2021-12-24 18:29:57,483 - trainer - INFO - Performance is lower than epoch: 30
2021-12-24 18:44:42,557 - trainer - INFO -     epoch          : 33
2021-12-24 18:44:42,656 - trainer - INFO -     loss           : 1.7175670688414513
2021-12-24 18:44:42,656 - trainer - INFO -     seq2seq_NDCG   : 0.6558312773704529
2021-12-24 18:44:42,656 - trainer - INFO -     seq2seq_NDCG16 : 0.7264185547828674
2021-12-24 18:44:42,656 - trainer - INFO -     val_loss       : 1.718330790801924
2021-12-24 18:44:42,657 - trainer - INFO -     val_seq2seq_NDCG: 0.6577046513557434
2021-12-24 18:44:42,657 - trainer - INFO -     val_seq2seq_NDCG16: 0.7271917462348938
2021-12-24 18:47:57,210 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-24 19:02:39,423 - trainer - INFO -     epoch          : 34
2021-12-24 19:02:40,760 - trainer - INFO -     loss           : 1.716782525829647
2021-12-24 19:02:40,760 - trainer - INFO -     seq2seq_NDCG   : 0.6546865105628967
2021-12-24 19:02:40,760 - trainer - INFO -     seq2seq_NDCG16 : 0.7266556620597839
2021-12-24 19:02:40,760 - trainer - INFO -     val_loss       : 1.7185943382126945
2021-12-24 19:02:40,760 - trainer - INFO -     val_seq2seq_NDCG: 0.6568960547447205
2021-12-24 19:02:40,760 - trainer - INFO -     val_seq2seq_NDCG16: 0.7271620035171509
2021-12-24 19:02:40,762 - trainer - INFO - Performance is lower than epoch: 33
2021-12-24 19:17:26,814 - trainer - INFO -     epoch          : 35
2021-12-24 19:17:27,064 - trainer - INFO -     loss           : 1.7160229298769665
2021-12-24 19:17:27,064 - trainer - INFO -     seq2seq_NDCG   : 0.6540650725364685
2021-12-24 19:17:27,064 - trainer - INFO -     seq2seq_NDCG16 : 0.7267672419548035
2021-12-24 19:17:27,064 - trainer - INFO -     val_loss       : 1.7194522692232717
2021-12-24 19:17:27,064 - trainer - INFO -     val_seq2seq_NDCG: 0.656755268573761
2021-12-24 19:17:27,065 - trainer - INFO -     val_seq2seq_NDCG16: 0.726842999458313
2021-12-24 19:17:27,066 - trainer - INFO - Performance is lower than epoch: 33
2021-12-24 19:32:21,794 - trainer - INFO -     epoch          : 36
2021-12-24 19:32:21,945 - trainer - INFO -     loss           : 1.7153193154908202
2021-12-24 19:32:21,945 - trainer - INFO -     seq2seq_NDCG   : 0.6536463499069214
2021-12-24 19:32:21,945 - trainer - INFO -     seq2seq_NDCG16 : 0.7270313501358032
2021-12-24 19:32:21,945 - trainer - INFO -     val_loss       : 1.7179347319262368
2021-12-24 19:32:21,945 - trainer - INFO -     val_seq2seq_NDCG: 0.6561203598976135
2021-12-24 19:32:21,945 - trainer - INFO -     val_seq2seq_NDCG16: 0.7273632884025574
2021-12-24 19:35:33,256 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-24 19:50:19,298 - trainer - INFO -     epoch          : 37
2021-12-24 19:50:19,426 - trainer - INFO -     loss           : 1.7145288560701453
2021-12-24 19:50:19,427 - trainer - INFO -     seq2seq_NDCG   : 0.65314781665802
2021-12-24 19:50:19,427 - trainer - INFO -     seq2seq_NDCG16 : 0.7271615266799927
2021-12-24 19:50:19,427 - trainer - INFO -     val_loss       : 1.718858457341486
2021-12-24 19:50:19,427 - trainer - INFO -     val_seq2seq_NDCG: 0.6550204753875732
2021-12-24 19:50:19,427 - trainer - INFO -     val_seq2seq_NDCG16: 0.7270904779434204
2021-12-24 19:50:19,429 - trainer - INFO - Performance is lower than epoch: 36
2021-12-24 20:05:05,989 - trainer - INFO -     epoch          : 38
2021-12-24 20:05:06,143 - trainer - INFO -     loss           : 1.7137447266322572
2021-12-24 20:05:06,143 - trainer - INFO -     seq2seq_NDCG   : 0.6526810526847839
2021-12-24 20:05:06,143 - trainer - INFO -     seq2seq_NDCG16 : 0.7274405360221863
2021-12-24 20:05:06,143 - trainer - INFO -     val_loss       : 1.7197803575165418
2021-12-24 20:05:06,143 - trainer - INFO -     val_seq2seq_NDCG: 0.6540029644966125
2021-12-24 20:05:06,144 - trainer - INFO -     val_seq2seq_NDCG16: 0.7270724177360535
2021-12-24 20:05:06,145 - trainer - INFO - Performance is lower than epoch: 36
2021-12-24 20:19:50,473 - trainer - INFO -     epoch          : 39
2021-12-24 20:19:50,523 - trainer - INFO -     loss           : 1.713281932694223
2021-12-24 20:19:50,524 - trainer - INFO -     seq2seq_NDCG   : 0.6519789099693298
2021-12-24 20:19:50,524 - trainer - INFO -     seq2seq_NDCG16 : 0.7275717854499817
2021-12-24 20:19:50,524 - trainer - INFO -     val_loss       : 1.718722589770142
2021-12-24 20:19:50,524 - trainer - INFO -     val_seq2seq_NDCG: 0.6532643437385559
2021-12-24 20:19:50,524 - trainer - INFO -     val_seq2seq_NDCG16: 0.7273343205451965
2021-12-24 20:19:50,526 - trainer - INFO - Performance is lower than epoch: 36
2021-12-24 20:34:37,560 - trainer - INFO -     epoch          : 40
2021-12-24 20:34:38,032 - trainer - INFO -     loss           : 1.7126330010726323
2021-12-24 20:34:38,033 - trainer - INFO -     seq2seq_NDCG   : 0.651574432849884
2021-12-24 20:34:38,033 - trainer - INFO -     seq2seq_NDCG16 : 0.7277750968933105
2021-12-24 20:34:38,033 - trainer - INFO -     val_loss       : 1.7192531082094933
2021-12-24 20:34:38,033 - trainer - INFO -     val_seq2seq_NDCG: 0.6524295806884766
2021-12-24 20:34:38,033 - trainer - INFO -     val_seq2seq_NDCG16: 0.726915717124939
2021-12-24 20:34:38,035 - trainer - INFO - Performance is lower than epoch: 36
2021-12-24 20:49:32,027 - trainer - INFO -     epoch          : 41
2021-12-24 20:49:32,065 - trainer - INFO -     loss           : 1.7119987602429012
2021-12-24 20:49:32,065 - trainer - INFO -     seq2seq_NDCG   : 0.6512241363525391
2021-12-24 20:49:32,065 - trainer - INFO -     seq2seq_NDCG16 : 0.7279143333435059
2021-12-24 20:49:32,066 - trainer - INFO -     val_loss       : 1.7198933873857771
2021-12-24 20:49:32,066 - trainer - INFO -     val_seq2seq_NDCG: 0.652822732925415
2021-12-24 20:49:32,066 - trainer - INFO -     val_seq2seq_NDCG16: 0.7267806529998779
2021-12-24 20:49:32,066 - trainer - INFO - Validation performance didn't improve for 4 epochs. Training stops.
