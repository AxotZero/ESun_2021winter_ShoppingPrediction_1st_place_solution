2021-12-19 19:32:46,294 - train - INFO - MultiIndexModelCnn(
  (embedder): FixedEmbedder(
    (embeddings): ModuleList(
      (0): Embedding(49, 32)
      (1): Embedding(4, 32)
      (2): Embedding(7, 32)
      (3): Embedding(30, 32)
      (4): Embedding(3, 32)
      (5): Embedding(12, 32)
      (6): Embedding(35, 32)
      (7): Embedding(3, 32)
      (8): Embedding(10, 32)
      (9): Embedding(2, 32)
    )
    (nns): ModuleList(
      (0): Linear(in_features=1, out_features=32, bias=True)
      (1): Linear(in_features=1, out_features=32, bias=True)
      (2): Linear(in_features=1, out_features=32, bias=True)
      (3): Linear(in_features=1, out_features=32, bias=True)
      (4): Linear(in_features=1, out_features=32, bias=True)
      (5): Linear(in_features=1, out_features=32, bias=True)
      (6): Linear(in_features=1, out_features=32, bias=True)
      (7): Linear(in_features=1, out_features=32, bias=True)
      (8): Linear(in_features=1, out_features=32, bias=True)
      (9): Linear(in_features=1, out_features=32, bias=True)
      (10): Linear(in_features=1, out_features=32, bias=True)
      (11): Linear(in_features=1, out_features=32, bias=True)
      (12): Linear(in_features=1, out_features=32, bias=True)
      (13): Linear(in_features=1, out_features=32, bias=True)
      (14): Linear(in_features=1, out_features=32, bias=True)
      (15): Linear(in_features=1, out_features=32, bias=True)
      (16): Linear(in_features=1, out_features=32, bias=True)
      (17): Linear(in_features=1, out_features=32, bias=True)
      (18): Linear(in_features=1, out_features=32, bias=True)
      (19): Linear(in_features=1, out_features=32, bias=True)
      (20): Linear(in_features=1, out_features=32, bias=True)
      (21): Linear(in_features=1, out_features=32, bias=True)
      (22): Linear(in_features=1, out_features=32, bias=True)
      (23): Linear(in_features=1, out_features=32, bias=True)
      (24): Linear(in_features=1, out_features=32, bias=True)
      (25): Linear(in_features=1, out_features=32, bias=True)
      (26): Linear(in_features=1, out_features=32, bias=True)
      (27): Linear(in_features=1, out_features=32, bias=True)
      (28): Linear(in_features=1, out_features=32, bias=True)
      (29): Linear(in_features=1, out_features=32, bias=True)
      (30): Linear(in_features=1, out_features=32, bias=True)
      (31): Linear(in_features=1, out_features=32, bias=True)
      (32): Linear(in_features=1, out_features=32, bias=True)
      (33): Linear(in_features=1, out_features=32, bias=True)
      (34): Linear(in_features=1, out_features=32, bias=True)
      (35): Linear(in_features=1, out_features=32, bias=True)
      (36): Linear(in_features=1, out_features=32, bias=True)
      (37): Linear(in_features=1, out_features=32, bias=True)
      (38): Linear(in_features=1, out_features=32, bias=True)
      (39): Linear(in_features=1, out_features=32, bias=True)
      (40): Linear(in_features=1, out_features=32, bias=True)
      (41): Linear(in_features=1, out_features=32, bias=True)
    )
  )
  (row_encoder): CnnEncoder(
    (batch_norm1): BatchNorm1d(1664, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout1): Dropout(p=0.44999999999999996, inplace=False)
    (dense1): Linear(in_features=1664, out_features=1536, bias=True)
    (batch_norm_c1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout_c1): Dropout(p=0.40499999999999997, inplace=False)
    (conv1): Conv1d(64, 128, kernel_size=(5,), stride=(1,), padding=(2,), bias=False)
    (ave_po_c1): AdaptiveAvgPool1d(output_size=12)
    (batch_norm_c2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout_c2): Dropout(p=0.36, inplace=False)
    (conv2): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    (batch_norm_c2_1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout_c2_1): Dropout(p=0.26999999999999996, inplace=False)
    (conv2_1): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    (batch_norm_c2_2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout_c2_2): Dropout(p=0.22499999999999998, inplace=False)
    (conv2_2): Conv1d(128, 128, kernel_size=(5,), stride=(1,), padding=(2,))
    (max_po_c2): MaxPool1d(kernel_size=4, stride=2, padding=1, dilation=1, ceil_mode=False)
    (flt): Flatten(start_dim=1, end_dim=-1)
    (batch_norm3): BatchNorm1d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (dropout3): Dropout(p=0.44999999999999996, inplace=False)
    (dense3): Linear(in_features=768, out_features=256, bias=True)
  )
  (rows_aggregator): Sequential(
    (0): Linear(in_features=12544, out_features=1536, bias=True)
    (1): LeakyReLU(negative_slope=0.01)
    (2): Dropout(p=0.6, inplace=False)
    (3): Linear(in_features=1536, out_features=1024, bias=True)
    (4): LeakyReLU(negative_slope=0.01)
    (5): Dropout(p=0.39999999999999997, inplace=False)
    (6): Linear(in_features=1024, out_features=512, bias=True)
    (7): LeakyReLU(negative_slope=0.01)
    (8): Dropout(p=0.3, inplace=False)
    (9): Linear(in_features=512, out_features=256, bias=True)
    (10): LeakyReLU(negative_slope=0.01)
  )
  (temporal_aggregator): Seq2SeqGruAggregator(
    (gru): GRU(256, 512, num_layers=3, batch_first=True, dropout=0.4)
  )
  (classifier): Sequential(
    (0): Linear(in_features=512, out_features=49, bias=True)
  )
)
Trainable parameters: 28849941.0
2021-12-19 19:33:35,105 - trainer - INFO - Loading checkpoint: ../save_dir/mm_cnn_hidden256_5fold/base/fold3/model_best.pth ...
2021-12-19 19:33:59,957 - trainer - INFO - Checkpoint loaded. Resume training from epoch 40
2021-12-19 19:48:41,407 - trainer - INFO -     epoch          : 40
2021-12-19 19:48:41,453 - trainer - INFO -     loss           : 1.7200622663778418
2021-12-19 19:48:41,454 - trainer - INFO -     seq2seq_NDCG   : 0.6647427082061768
2021-12-19 19:48:41,454 - trainer - INFO -     seq2seq_NDCG16 : 0.7255327701568604
2021-12-19 19:48:41,454 - trainer - INFO -     val_loss       : 1.7207053078680623
2021-12-19 19:48:41,454 - trainer - INFO -     val_seq2seq_NDCG: 0.6629062294960022
2021-12-19 19:48:41,454 - trainer - INFO -     val_seq2seq_NDCG16: 0.7262187600135803
2021-12-19 19:48:42,356 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-19 20:03:26,988 - trainer - INFO -     epoch          : 41
2021-12-19 20:03:27,043 - trainer - INFO -     loss           : 1.7183621252894097
2021-12-19 20:03:27,043 - trainer - INFO -     seq2seq_NDCG   : 0.6615614295005798
2021-12-19 20:03:27,044 - trainer - INFO -     seq2seq_NDCG16 : 0.7261555194854736
2021-12-19 20:03:27,044 - trainer - INFO -     val_loss       : 1.7204374810870813
2021-12-19 20:03:27,044 - trainer - INFO -     val_seq2seq_NDCG: 0.6607757806777954
2021-12-19 20:03:27,044 - trainer - INFO -     val_seq2seq_NDCG16: 0.7263197302818298
2021-12-19 20:03:53,067 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-19 20:18:34,728 - trainer - INFO -     epoch          : 42
2021-12-19 20:18:34,769 - trainer - INFO -     loss           : 1.7173571397581369
2021-12-19 20:18:34,769 - trainer - INFO -     seq2seq_NDCG   : 0.6598955392837524
2021-12-19 20:18:34,769 - trainer - INFO -     seq2seq_NDCG16 : 0.7264676094055176
2021-12-19 20:18:34,769 - trainer - INFO -     val_loss       : 1.7200284253577798
2021-12-19 20:18:34,769 - trainer - INFO -     val_seq2seq_NDCG: 0.6594000458717346
2021-12-19 20:18:34,770 - trainer - INFO -     val_seq2seq_NDCG16: 0.7264344692230225
2021-12-19 20:19:00,975 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-19 20:33:52,761 - trainer - INFO -     epoch          : 43
2021-12-19 20:33:52,785 - trainer - INFO -     loss           : 1.7163757988254127
2021-12-19 20:33:52,786 - trainer - INFO -     seq2seq_NDCG   : 0.6587265729904175
2021-12-19 20:33:52,786 - trainer - INFO -     seq2seq_NDCG16 : 0.7268186807632446
2021-12-19 20:33:52,786 - trainer - INFO -     val_loss       : 1.7198063390595573
2021-12-19 20:33:52,786 - trainer - INFO -     val_seq2seq_NDCG: 0.6593139171600342
2021-12-19 20:33:52,786 - trainer - INFO -     val_seq2seq_NDCG16: 0.7262895107269287
2021-12-19 20:34:28,690 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-19 20:49:07,371 - trainer - INFO -     epoch          : 44
2021-12-19 20:49:07,403 - trainer - INFO -     loss           : 1.7158510968508318
2021-12-19 20:49:07,403 - trainer - INFO -     seq2seq_NDCG   : 0.6577849984169006
2021-12-19 20:49:07,403 - trainer - INFO -     seq2seq_NDCG16 : 0.7269802689552307
2021-12-19 20:49:07,404 - trainer - INFO -     val_loss       : 1.71999755380105
2021-12-19 20:49:07,404 - trainer - INFO -     val_seq2seq_NDCG: 0.6579362154006958
2021-12-19 20:49:07,404 - trainer - INFO -     val_seq2seq_NDCG16: 0.7263911962509155
2021-12-19 20:49:07,406 - trainer - INFO - Performance is lower than epoch: 43
2021-12-19 21:03:42,764 - trainer - INFO -     epoch          : 45
2021-12-19 21:03:42,796 - trainer - INFO -     loss           : 1.7150595768943162
2021-12-19 21:03:42,796 - trainer - INFO -     seq2seq_NDCG   : 0.6571415066719055
2021-12-19 21:03:42,796 - trainer - INFO -     seq2seq_NDCG16 : 0.7272021174430847
2021-12-19 21:03:42,796 - trainer - INFO -     val_loss       : 1.7194349711038628
2021-12-19 21:03:42,797 - trainer - INFO -     val_seq2seq_NDCG: 0.6563820242881775
2021-12-19 21:03:42,797 - trainer - INFO -     val_seq2seq_NDCG16: 0.7264947295188904
2021-12-19 21:04:08,758 - trainer - INFO - Improved! Saving current best: model_best.pth ...
2021-12-19 21:18:43,010 - trainer - INFO -     epoch          : 46
2021-12-19 21:18:43,052 - trainer - INFO -     loss           : 1.7142804428134732
2021-12-19 21:18:43,052 - trainer - INFO -     seq2seq_NDCG   : 0.6560388803482056
2021-12-19 21:18:43,052 - trainer - INFO -     seq2seq_NDCG16 : 0.7274243235588074
2021-12-19 21:18:43,052 - trainer - INFO -     val_loss       : 1.719807891213164
2021-12-19 21:18:43,053 - trainer - INFO -     val_seq2seq_NDCG: 0.6562393307685852
2021-12-19 21:18:43,053 - trainer - INFO -     val_seq2seq_NDCG16: 0.7263616323471069
2021-12-19 21:18:43,054 - trainer - INFO - Performance is lower than epoch: 45
2021-12-19 21:33:15,552 - trainer - INFO -     epoch          : 47
2021-12-19 21:33:15,597 - trainer - INFO -     loss           : 1.713670022042511
2021-12-19 21:33:15,597 - trainer - INFO -     seq2seq_NDCG   : 0.6555907726287842
2021-12-19 21:33:15,597 - trainer - INFO -     seq2seq_NDCG16 : 0.7276432514190674
2021-12-19 21:33:15,597 - trainer - INFO -     val_loss       : 1.720272491781079
2021-12-19 21:33:15,597 - trainer - INFO -     val_seq2seq_NDCG: 0.6554978489875793
2021-12-19 21:33:15,598 - trainer - INFO -     val_seq2seq_NDCG16: 0.7262884378433228
2021-12-19 21:33:15,599 - trainer - INFO - Performance is lower than epoch: 45
2021-12-19 21:47:50,309 - trainer - INFO -     epoch          : 48
2021-12-19 21:47:50,339 - trainer - INFO -     loss           : 1.7129623928033482
2021-12-19 21:47:50,339 - trainer - INFO -     seq2seq_NDCG   : 0.6552795171737671
2021-12-19 21:47:50,339 - trainer - INFO -     seq2seq_NDCG16 : 0.7278181910514832
2021-12-19 21:47:50,339 - trainer - INFO -     val_loss       : 1.719635623450182
2021-12-19 21:47:50,340 - trainer - INFO -     val_seq2seq_NDCG: 0.6548685431480408
2021-12-19 21:47:50,340 - trainer - INFO -     val_seq2seq_NDCG16: 0.7264851927757263
2021-12-19 21:47:50,341 - trainer - INFO - Performance is lower than epoch: 45
2021-12-19 22:02:24,120 - trainer - INFO -     epoch          : 49
2021-12-19 22:02:24,154 - trainer - INFO -     loss           : 1.7124687928677824
2021-12-19 22:02:24,154 - trainer - INFO -     seq2seq_NDCG   : 0.6549128293991089
2021-12-19 22:02:24,155 - trainer - INFO -     seq2seq_NDCG16 : 0.7279675006866455
2021-12-19 22:02:24,155 - trainer - INFO -     val_loss       : 1.7202937511765226
2021-12-19 22:02:24,155 - trainer - INFO -     val_seq2seq_NDCG: 0.6542646884918213
2021-12-19 22:02:24,155 - trainer - INFO -     val_seq2seq_NDCG16: 0.7262032628059387
2021-12-19 22:02:24,157 - trainer - INFO - Performance is lower than epoch: 45
2021-12-19 22:16:57,215 - trainer - INFO -     epoch          : 50
2021-12-19 22:16:57,234 - trainer - INFO -     loss           : 1.711923631560772
2021-12-19 22:16:57,235 - trainer - INFO -     seq2seq_NDCG   : 0.6538711190223694
2021-12-19 22:16:57,235 - trainer - INFO -     seq2seq_NDCG16 : 0.7280734777450562
2021-12-19 22:16:57,235 - trainer - INFO -     val_loss       : 1.7203655899787436
2021-12-19 22:16:57,235 - trainer - INFO -     val_seq2seq_NDCG: 0.6544581651687622
2021-12-19 22:16:57,235 - trainer - INFO -     val_seq2seq_NDCG16: 0.7263790965080261
2021-12-19 22:16:57,236 - trainer - INFO - Validation performance didn't improve for 4 epochs. Training stops.
